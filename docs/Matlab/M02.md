# 整数规划

### 定义

数学规划中二点变量（部分或全部）限制位整数时，称为整数规划。  
若在线性规划模型中，变量限制为整数，则称为整数线性规划。

### 分类

1. 变量全限制为整数时，称纯（完全）整数规划。
2. 变量部分限制为整数的，称混合整数规划。

### 特点

1. 原线性规划有最优解，当自变量限制为整数后，其整数规划解出现下述情况
    - 原线性规划最优解全是整数，则整数规划最优解与线性规划最优解一致。
    - 整数规划无可行解。
    - 有可行解（当然就存在最优解），但最优解值变差。
2. 整数规划最优解不能按照实数最优解简单取整而获得。

### 相关问题

***e.g.*** 合理下料

***e.g.*** 建厂问题

***e.g.*** 指派问题

***e.g.*** 投资问题

***e.g.*** 互斥约束问题

***e.g.*** 固定费用问题
 
### 具体分析
依照决策变量取整要求的不同， 整数规划可分为
- 纯整数规划: 所有决策变量要求取非负整数（这时引进的松弛变量和剩余变量可以不要求取整数）。
- 全整数规划: 除了所有决策变量要求取非负整数外，系数aij和常数bi也要求取整数（这时引进的松弛变量和剩余变量也必须是整数）。
- 混合整数规划: 只有一部分的决策变量要求取非负整数，另一部分可以取非负实数。
- 0-1整数规划: 所有决策变量只能取 0 或 1 两个整数。

### 整数规划与线性规划的关系
整数规划可行解是松弛问题可行域中的整数格点；  
ILP最优值小于或等于松弛问题的最优值；  
松弛问题无可行解， 则整数规划无可行解；  
松弛问题最优解满足整数要求， 则该最优解为整数规划最优解；

### 整数线性规划的求解方法
从数学模型上看整数规划似乎是线性规划的一种特殊形式，  
求解只需要在线性规划的基础上通过舍入取整，寻求满足整数要求的解即可。

### 分支定界算法
不考虑整数限制先求出相应松弛问题的最优解，
- 若松弛问题无可行解， 则ILP无可行解；
- 若求得的松弛问题最优解符合整数要求， 则是ILP的最优解；
- 若不满足整数条件， 则任选一个不满足整数条件的变量$ x_{i}^{0} $
 来构造新的约束添加到松弛问题中形成两个子问题$ x_i \le [x_{i}^{0}] \ ;\  x_i \ge [x_{i}^{0}] + 1 $
- 依次在缩小的可行域中求解新构造的线性规划的最优解，并重复上述过程，直到子问题无解或有整数最优解（被查清）。

### 割平面算法
- 如果松弛问题(P0)无解， 则(P)无解；
- 如果(P0)的最优解为整数向量，则也是(P)的最优解；
- 如果(P0)的解含有非整数分量，则对(P0)增加割平面条件：即对(P0)增加一个线性约束，将(P0)的可行区域割掉一块，使得非整数解恰好在割掉的一块中，但又没有割掉原问题(P)的可行解，得到问题(P1)，重复上述的过程。

### 割平面算法基本步骤
1. 求解线性规划最优解
2. 
$$ x_i + \sum a_{ik}x_k = b_i $$
$$ a_{ik} = [a_{ik}] + (a_{ik} - La_{ik}) = [a_{ik}] + f_{ik} $$
$$ b_i = [b_i] + (b_i - Lb_i) = [b_i] + f_i $$
3. 
$$ x_i + \sum [a_{ik}]x_k + \sum [f_{ik}]x_k = [b_i] + f_i $$
$$ x_i + \sum [a_{ik}x_k - [b_i] = - \sum [f_{ik}]x_k + f_i $$

### 互斥约束的推广
从下述p个约束条件中恰好选择q个约束条件$ \displaystyle\sum_{j=1}^{n} a_{ij}x_j \le b_i (i = 1, 2, \cdots, p) $
$$
(i = 1, 2, \cdots, p) \quad
\begin{cases}
\displaystyle\sum_{j=1}^{n} a_{ij}x_j \le b_i + My_i \\
\displaystyle\sum_{i=1}^{p} y_i = p - q
\end{cases}
$$

### 指派问题的标准形式
有n个人和n项工作，已知第i个人做第j项工作的代价为$c_{ij} (i, j=1, \cdots, n)$,  
要求每项工作只能交与其中一人完成，每个人只能完成其中一项工作，问如何分配可使总代价最少？  
指派问题的系数矩阵: 
$$ 
C = (c_{ij})_{n \times n} = 
\begin{bmatrix}
{c_{11}}&{c_{12}}&{\cdots}&{c_{1n}}\\
{c_{21}}&{c_{22}}&{\cdots}&{c_{2n}}\\
{\vdots}&{\vdots}&{\ddots}&{\vdots}\\
{c_{n1}}&{c_{n2}}&{\cdots}&{c_{nn}}\\
\end{bmatrix}
$$
i行元素 —— 第i个人完成各项任务的代价  
j列元素 —— 各人完成第j项工作的代价

### 指派问题的数学模型